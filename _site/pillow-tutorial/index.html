<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Pillow Tutorial | MEE404 - Machine Vision in Mechatronics</title>
<meta name="generator" content="Jekyll v3.7.0" />
<meta property="og:title" content="Pillow Tutorial" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Course materials and notes for IKC Universtiy class MEE404: Machine Vision in Mechatronics." />
<meta property="og:description" content="Course materials and notes for IKC Universtiy class MEE404: Machine Vision in Mechatronics." />
<link rel="canonical" href="http://localhost:4000/pillow-tutorial/" />
<meta property="og:url" content="http://localhost:4000/pillow-tutorial/" />
<meta property="og:site_name" content="MEE404 - Machine Vision in Mechatronics" />
<script type="application/ld+json">
{"headline":"Pillow Tutorial","description":"Course materials and notes for IKC Universtiy class MEE404: Machine Vision in Mechatronics.","@type":"WebPage","url":"http://localhost:4000/pillow-tutorial/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link href='https://fonts.googleapis.com/css?family=Lato:300italic,700italic,300,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <script src="/assets/js/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header >
        <h1>MEE404 - Machine Vision in Mechatronics</h1>
        
          <p>Course materials and notes for IKC Universtiy class MEE404: Machine Vision in Mechatronics.</p>
        
        <p class="view"><a href="">View the Project on GitHub <small></small></a></p>
        <ul>
        
          <li><a href="">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>

      <p>In this course we will use python’s PIL ( aka pillow) library. The following examples show the common usage of the library.</p>

<h2 id="example-1">EXAMPLE 1</h2>

<p>In this example the script simply opens and shows an image file.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Images</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'lena.png'</span><span class="p">)</span>
<span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/lena.png" alt="" height="50%" width="50%" /></p>

<p>Lena image is a well-know image in processing literature. We will be dealing with this image and its gray scale version during the class throughout the semester. The above script simply reads a given image file and shows it with a predefined viewer program specific for your operating system.</p>

<h2 id="example-2">EXAMPLE 2</h2>

<p>In this example the script simply opens and shows an image file.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Images</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">'lena.png'</span><span class="p">)</span>
<span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>

<p><img src="/assets/lena.png" alt="" height="50%" width="50%" /></p>

<p>Lena image is a well-know image in processing literature. We will be dealing with this image and its gray scale version during the class throughout the semester. The above script simply reads a given image file and shows it with a predefined viewer program specific for your operating system.</p>

<h2 id="example-3">EXAMPLE 3</h2>

<p>It is easy to select a rectangular box rotate in and poste it back. The following script can be given as an example.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Images</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"lena.png"</span><span class="p">)</span>
<span class="n">box</span> <span class="o">=</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span> <span class="c">#c.c.w.</span>
<span class="n">im</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">region</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span>
<span class="n">im</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></div>
<p><img src="/assets/lena-crop.png" alt="" height="50%" width="50%" /></p>

<h2 id="example-4">EXAMPLE 4</h2>

<p>Once a color image is read, it is possible to split it into Red, Green and Blue Color components. The following script reads RGB Lena image and splits its RGB channels and saves them as separate JPEG image files.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"lena.png"</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">color_name</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s">'RED'</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s">'GREEN'</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="s">'BLUE'</span><span class="p">}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
	<span class="n">file_name</span> <span class="o">=</span> <span class="s">'lena-'</span><span class="o">+</span><span class="n">color_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="s">'.jpg'</span>
	<span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span><span class="s">'JPEG'</span><span class="p">)</span>
	<span class="k">print</span> <span class="n">i</span><span class="p">,</span><span class="n">file_name</span>
</code></pre></div></div>
<p><img src="/assets/lena-split.png" alt="" height="70%" width="100%" /></p>

<h2 id="example-5">EXAMPLE 5</h2>

<p>It is also possible to use predefined optimised filters for image manipulation. The following script reads Lena file and blurs it twice and saves both blurred images as separate JPEG files.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span><span class="n">ImageFilter</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"lena.png"</span><span class="p">)</span>
<span class="n">im_blur</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">ImageFilter</span><span class="o">.</span><span class="n">BLUR</span><span class="p">)</span>
<span class="n">im_blur2</span> <span class="o">=</span> <span class="n">im_blur</span><span class="o">.</span><span class="p">(</span><span class="n">ImageFilter</span><span class="o">.</span><span class="n">BLUR</span><span class="p">)</span>
<span class="n">im_blur</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'lena-blur.jpg'</span><span class="p">,</span><span class="s">'JPEG'</span><span class="p">)</span>
<span class="n">im_blur2</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'lena-blur2.jpg'</span><span class="p">,</span><span class="s">'JPEG'</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/assets/lena-blur.png" alt="" height="70%" width="100%" /></p>

<h2 id="example-6">EXAMPLE 6</h2>

<p>Similarly operaions like Edge Detection can also be performed by using PILs predefined filters. The following script performs edge detection operation after reading Lena file.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span><span class="n">ImageFilter</span>

<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="nb">open</span><span class="p">(</span><span class="s">"lena.png"</span><span class="p">)</span>
<span class="n">im_edges</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="nb">filter</span><span class="p">(</span><span class="n">ImageFilter</span><span class="o">.</span><span class="n">FIND_EDGES</span><span class="p">)</span>
<span class="n">im_edges</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'edges.jpg'</span><span class="p">,</span><span class="s">'JPEG'</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/assets/lena-edge.png" alt="" height="70%" width="100%" /></p>

<h2 id="example-7">EXAMPLE 7</h2>

<p>In this example we want to create an image file from scratch. The aim is to create an image which is darkest at its center and brightest at image corners. In order to create such an image, mathematical definition of circle can be used. The following code is trying to create such an image. It defines a circle located at the image center. The desired result is the image on the right but if you run the following script you get the image on the left. There is a little flaw in the following script. Can you find and fix it such that the code generates the image n the right?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="n">height</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">600</span>

<span class="c"># Create an empty array</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c">#Create [x,y] coordinate combinations on grid</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[:</span><span class="n">height</span><span class="p">,</span> <span class="p">:</span><span class="n">width</span><span class="p">]</span>
<span class="c">#Mathematical definiton of a circle centered at (200,200)</span>
<span class="n">circle</span> <span class="o">=</span> <span class="p">(</span><span class="n">xx</span> <span class="o">-</span> <span class="mi">200</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yy</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

<span class="c"># Set the RGB values</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">intensity</span>  <span class="o">=</span> <span class="n">circle</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="n">img</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">intensity</span>

<span class="c">#Save Image directly from buffer</span>
<span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">img</span><span class="p">,</span><span class="s">'L'</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">'circle-bad.png'</span><span class="p">,</span><span class="s">'PNG'</span><span class="p">)</span>
</code></pre></div></div>
<p><img src="/assets/circle-bad.png" alt="circle bad" height="49%" width="49%" />    <img src="/assets/circle-good.png" alt="circle good" height="49%" width="49%" /></p>


      </section>
    </div>
    <footer>
    
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->

    
  </body>
</html>
